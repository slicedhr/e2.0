{"version":3,"sources":["productos/productos-controller.js"],"names":[],"mappings":"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","file":"productos/productos-controller.js","sourcesContent":["(function () {\n  'use strict';\n\n  /**\n   * @ngdoc object\n   * @name productos.controller:ProductosCtrl\n   *\n   * @description\n   *\n   */\n  angular\n    .module('productos')\n    .controller('ProductosCtrl', ProductosCtrl);\n\n  function ProductosCtrl(AppService, $rootScope, $scope) {\n\n    var self = this;\n\n    this.selected = []\n\n    this.page = 1\n\n    this.limit = 10\n\n    this.base = 'productos'\n\n    this.title = 'Productos'\n\n    this.templateForm  = 'productos-form'\n\n    this.search = {\n      \n      icon: 'search',\n\n      toggleSearch: () => {\n\n          self.search.showInput = !self.search.showInput\n\n          self.search.icon = self.search.showInput ? 'cancel' : 'search'\n\n      },\n\n      fire: (data, categoria = false) => {\n\n        var query = {}\n\n\n        query[self.search.by] = categoria ? data : {\n\n          \"contains\" : data\n\n        }\n\n        query = 'where=' + JSON.stringify(query)\n\n\n        self.page = 1;\n\n        var config = {\n\n          url: self.base,\n\n          query: query,\n\n          page: self.page,\n\n          limit: self.limit\n\n        }\n\n        AppService\n          .get(config)\n          .then( success => {\n\n            var data = success.data\n\n            data.query = query\n\n            $rootScope.$broadcast('filtered', data)\n\n          })\n      },\n\n\n      columns: [\n        {\n          key: 'categoria',\n          title: 'CategorÃ­a',\n          selected: true\n        },\n        {\n          key: 'nombre',\n          title: 'Nombre'\n        },\n        {\n          key: 'referencia',\n          title: 'Referencia'\n        },\n      ],\n\n    }\n\n\n    //Get\n\n    this.$get = (page, limit, order) => {\n\n      AppService.scrollToTop('#mainContent')\n\n      AppService\n        .get({\n\n          page: page,\n          \n          url: self.base,\n          \n          limit: limit,\n\n          query: self.query || undefined,\n\n          order: order || undefined\n\n        })\n\n        .then(success => {\n\n          self.rows = []\n\n          self.rows = success.data.results\n\n          self.total = success.data.info.total\n\n\n        })\n        .catch(err => {\n\n          console.log(err)\n\n        })\n\n    }\n\n\n    this.$get(self.page, self.limit)\n\n    //GET CATEGORIAS\n    AppService\n        .get({\n\n          page: 0,\n          \n          url: 'categoriasproductos',\n          \n          limit: 100,\n\n          order: 'nombre_categoria ASC'\n\n        })\n\n        .then(success => {\n\n          self.categoriasproductos = success.data.results\n\n        })\n        .catch(err => {\n\n          console.log(err)\n\n        })\n\n\n    //Show Form Edit/Create\n    \n    this.form = ($event, item, duplication = false) => {\n\n      self.dataToForm = {}\n\n      if (item && !duplication){\n\n        var options = {\n\n          array: self.rows,\n\n          condicion: { id: item.id }\n\n        }\n\n        var index = AppService.filter(options)\n\n        self.dataToForm = self.rows[index];\n\n        self.tempData = angular.copy(self.rows[index])\n\n      };\n\n      if (duplication){\n\n        self.dataToForm = angular.copy(item)\n\n        delete self.dataToForm.id\n\n        delete self.dataToForm.$hashKey\n\n      }\n\n      var dialog = {\n\n        scope: $scope,\n\n        targetEvent: $event,\n\n        dataToForm: self.dataToForm,\n\n        title: self.title,\n\n        source: self.base,\n\n        template: self.templateForm\n\n      }\n\n      AppService\n        .showFormDialog(dialog)\n        .then( data => {\n\n\n         if (data){\n\n          if( item && angular.equals(angular.copy(item), self.tempData) && !duplication)\n            self.rows[index] = data\n\n          if ( !item || duplication)\n            self.rows.push(data)\n\n         }\n\n\n        })\n        .catch(err => {\n\n\n        })\n\n    }\n\n\n    //Delete\n    \n    this.delete = ($event, id) => {\n\n      AppService\n        .deleteDialog($event)\n        .then(() => \n\n          AppService\n                    .delete(self.base, id)\n\n        )\n\n        .then(response => {\n              \n          var options = {\n\n            array: self.rows,\n\n            condicion: { id: response.data.id }\n\n          }\n\n          var index = AppService.filter(options)\n\n          self.rows.splice(index, 1)\n\n          $('.scroller').scrollTop($('.scroller').scrollTop + 1)\n\n        })\n        .catch(() => {\n\n        })\n\n    }\n\n    this.getSelected = data => {\n\n      console.log(self.selected)\n\n    }\n\n    this.keysToString = (keys, obj) => {\n\n      if (!keys.contains('>'))\n        return obj[keys]\n\n      else{\n\n        var keys = keys.split('>')\n\n        var temp = obj\n\n        for (var i = 0; i < keys.length; i++)\n          temp = temp[ keys[ i ] ]\n\n        return temp\n\n      }\n\n    }\n\n    //On filtered\n    \n    $rootScope.$on('filtered', ($event, data) => {\n\n      AppService.scrollToTop('#mainContent')\n\n      self.rows = data.results\n\n      self.total = data.info.total\n\n      self.page = data.info.start + 1\n\n      self.limit = data.info.limit\n\n      self.query = data.query\n\n\n    })\n\n    \n\n    self.onOrderChange = function(){\n\n       var order = self.order\n\n      if (order.contains('-'))\n        order = self.order.replace('-', '') + ' ASC'\n      \n      else\n        order = order + ' DESC'\n\n      self.$get(1, self.limit, order)\n\n    }\n    \n  }\n}());\n"],"sourceRoot":"/source/"}